2022-06-21 14:13:09 | INFO | fairseq.trainer | begin training epoch 1
2022-06-21 14:13:09 | INFO | fairseq_cli.train | Start iterating over samples
/local/home/VD/cychang/fairseq/fairseq/utils.py:375: UserWarning: amp_C fused kernels unavailable, disabling multi_tensor_l2norm; you may get better performance by installing NVIDIA's apex library
  "amp_C fused kernels unavailable, disabling multi_tensor_l2norm; "
2022-06-21 14:13:12 | INFO | train_inner | {"epoch": 1, "update": 0.053, "loss": "12.666", "nll_loss": "12.651", "ppl": "6431.18", "wps": "61021.8", "ups": "8.86", "wpb": "6993.7", "bsz": "256", "num_updates": "10", "lr": "1.25e-06", "gnorm": "1.679", "train_wall": "1", "gb_free": "31.4", "wall": "8"}
2022-06-21 14:13:13 | INFO | train_inner | {"epoch": 1, "update": 0.107, "loss": "12.634", "nll_loss": "12.587", "ppl": "6152.95", "wps": "88435.6", "ups": "10.88", "wpb": "8125.1", "bsz": "256", "num_updates": "20", "lr": "2.5e-06", "gnorm": "1.752", "train_wall": "1", "gb_free": "31.3", "wall": "8"}
2022-06-21 14:13:14 | INFO | train_inner | {"epoch": 1, "update": 0.16, "loss": "12.562", "nll_loss": "12.443", "ppl": "5566.76", "wps": "90336.9", "ups": "11.13", "wpb": "8113.6", "bsz": "256", "num_updates": "30", "lr": "3.75e-06", "gnorm": "1.718", "train_wall": "1", "gb_free": "31.4", "wall": "9"}
2022-06-21 14:13:15 | INFO | train_inner | {"epoch": 1, "update": 0.214, "loss": "12.453", "nll_loss": "12.226", "ppl": "4792.17", "wps": "81636.3", "ups": "10.47", "wpb": "7797.6", "bsz": "256", "num_updates": "40", "lr": "5e-06", "gnorm": "1.613", "train_wall": "1", "gb_free": "31", "wall": "10"}
2022-06-21 14:13:16 | INFO | train_inner | {"epoch": 1, "update": 0.267, "loss": "12.369", "nll_loss": "12.056", "ppl": "4258.61", "wps": "82930.2", "ups": "10.34", "wpb": "8021.8", "bsz": "253.6", "num_updates": "50", "lr": "6.25e-06", "gnorm": "1.484", "train_wall": "1", "gb_free": "31.2", "wall": "11"}
2022-06-21 14:13:17 | INFO | train_inner | {"epoch": 1, "update": 0.321, "loss": "12.186", "nll_loss": "11.69", "ppl": "3303.03", "wps": "78776.9", "ups": "10.99", "wpb": "7165.5", "bsz": "256", "num_updates": "60", "lr": "7.5e-06", "gnorm": "1.272", "train_wall": "1", "gb_free": "31.3", "wall": "12"}
2022-06-21 14:13:17 | INFO | train_inner | {"epoch": 1, "update": 0.374, "loss": "12.069", "nll_loss": "11.453", "ppl": "2802.89", "wps": "89761.8", "ups": "11.05", "wpb": "8123.9", "bsz": "256", "num_updates": "70", "lr": "8.75e-06", "gnorm": "1.118", "train_wall": "1", "gb_free": "31.1", "wall": "13"}
2022-06-21 14:13:18 | INFO | train_inner | {"epoch": 1, "update": 0.428, "loss": "11.96", "nll_loss": "11.237", "ppl": "2414.39", "wps": "78620.6", "ups": "10.85", "wpb": "7246.1", "bsz": "256", "num_updates": "80", "lr": "1e-05", "gnorm": "0.924", "train_wall": "1", "gb_free": "31.3", "wall": "14"}
2022-06-21 14:13:19 | INFO | train_inner | {"epoch": 1, "update": 0.481, "loss": "11.89", "nll_loss": "11.114", "ppl": "2216.74", "wps": "80650.8", "ups": "11.03", "wpb": "7313.7", "bsz": "256", "num_updates": "90", "lr": "1.125e-05", "gnorm": "0.871", "train_wall": "1", "gb_free": "31.4", "wall": "15"}
2022-06-21 14:13:20 | INFO | train_inner | {"epoch": 1, "update": 0.535, "loss": "11.756", "nll_loss": "10.855", "ppl": "1852.11", "wps": "87211.5", "ups": "10.27", "wpb": "8495.4", "bsz": "256", "num_updates": "100", "lr": "1.25e-05", "gnorm": "0.725", "train_wall": "1", "gb_free": "31.3", "wall": "16"}
2022-06-21 14:13:21 | INFO | train_inner | {"epoch": 1, "update": 0.588, "loss": "11.726", "nll_loss": "10.812", "ppl": "1798.02", "wps": "85417.2", "ups": "11.43", "wpb": "7471.4", "bsz": "256", "num_updates": "110", "lr": "1.375e-05", "gnorm": "0.719", "train_wall": "1", "gb_free": "31", "wall": "17"}
2022-06-21 14:13:22 | INFO | train_inner | {"epoch": 1, "update": 0.642, "loss": "11.68", "nll_loss": "10.732", "ppl": "1701.21", "wps": "84008.1", "ups": "11.12", "wpb": "7552.3", "bsz": "256", "num_updates": "120", "lr": "1.5e-05", "gnorm": "0.667", "train_wall": "1", "gb_free": "31.1", "wall": "18"}
2022-06-21 14:13:23 | INFO | train_inner | {"epoch": 1, "update": 0.695, "loss": "11.617", "nll_loss": "10.63", "ppl": "1584.67", "wps": "76368.3", "ups": "10.62", "wpb": "7191.2", "bsz": "256", "num_updates": "130", "lr": "1.625e-05", "gnorm": "0.565", "train_wall": "1", "gb_free": "31.4", "wall": "19"}
2022-06-21 14:13:24 | INFO | train_inner | {"epoch": 1, "update": 0.749, "loss": "11.534", "nll_loss": "10.489", "ppl": "1437.55", "wps": "77024.5", "ups": "10.83", "wpb": "7111.8", "bsz": "253.1", "num_updates": "140", "lr": "1.75e-05", "gnorm": "0.52", "train_wall": "1", "gb_free": "31.1", "wall": "20"}
2022-06-21 14:13:25 | INFO | train_inner | {"epoch": 1, "update": 0.802, "loss": "11.547", "nll_loss": "10.527", "ppl": "1475.42", "wps": "79846.3", "ups": "10.75", "wpb": "7427.2", "bsz": "256", "num_updates": "150", "lr": "1.875e-05", "gnorm": "0.646", "train_wall": "1", "gb_free": "31.3", "wall": "20"}
2022-06-21 14:13:26 | INFO | train_inner | {"epoch": 1, "update": 0.856, "loss": "11.461", "nll_loss": "10.369", "ppl": "1322.57", "wps": "81384.7", "ups": "11.27", "wpb": "7222.9", "bsz": "256", "num_updates": "160", "lr": "2e-05", "gnorm": "0.465", "train_wall": "1", "gb_free": "31.4", "wall": "21"}
2022-06-21 14:13:27 | INFO | train_inner | {"epoch": 1, "update": 0.909, "loss": "11.388", "nll_loss": "10.249", "ppl": "1217.22", "wps": "88777.1", "ups": "10.86", "wpb": "8176.3", "bsz": "256", "num_updates": "170", "lr": "2.125e-05", "gnorm": "0.461", "train_wall": "1", "gb_free": "30.9", "wall": "22"}
2022-06-21 14:13:28 | INFO | train_inner | {"epoch": 1, "update": 0.963, "loss": "11.397", "nll_loss": "10.267", "ppl": "1231.86", "wps": "79186.8", "ups": "10.43", "wpb": "7593.4", "bsz": "256", "num_updates": "180", "lr": "2.25e-05", "gnorm": "0.532", "train_wall": "1", "gb_free": "31.5", "wall": "23"}
2022-06-21 14:13:28 | INFO | fairseq_cli.train | begin validation on "valid" subset
2022-06-21 14:13:32 | INFO | valid | {"epoch": 1, "valid_loss": "11.191", "valid_nll_loss": "9.886", "valid_ppl": "946.01", "valid_wps": "334081", "valid_wpb": "7421.2", "valid_bsz": "244.4", "valid_num_updates": "187"}
2022-06-21 14:13:32 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 1 @ 187 updates
2022-06-21 14:13:32 | INFO | fairseq.trainer | Saving checkpoint to /home/VD/cychang/ironside_nmt/bpe_pcm_en_300_32_1024_ffnn_checkpoints/checkpoint_best.pt
2022-06-21 14:13:32 | INFO | fairseq.trainer | Finished saving checkpoint to /home/VD/cychang/ironside_nmt/bpe_pcm_en_300_32_1024_ffnn_checkpoints/checkpoint_best.pt
2022-06-21 14:13:32 | INFO | fairseq.checkpoint_utils | Saved checkpoint /home/VD/cychang/ironside_nmt/bpe_pcm_en_300_32_1024_ffnn_checkpoints/checkpoint_best.pt (epoch 1 @ 187 updates, score 11.191) (writing took 0.7378068640828133 seconds)
2022-06-21 14:13:32 | INFO | fairseq_cli.train | end of epoch 1 (average epoch stats below)
2022-06-21 14:13:32 | INFO | train | {"epoch": 1, "train_loss": "11.921", "train_nll_loss": "11.212", "train_ppl": "2371.75", "train_wps": "65941.3", "train_ups": "8.66", "train_wpb": "7612.5", "train_bsz": "255.4", "train_num_updates": "187", "train_lr": "2.3375e-05", "train_gnorm": "0.965", "train_train_wall": "17", "train_gb_free": "31.2", "train_wall": "28"}
2022-06-21 14:13:32 | INFO | fairseq.data.iterators | grouped total_num_itrs = 187
2022-06-21 14:13:32 | INFO | fairseq.trainer | begin training epoch 2
2022-06-21 14:13:32 | INFO | fairseq_cli.train | Start iterating over samples
2022-06-21 14:13:35 | INFO | train_inner | {"epoch": 2, "update": 1.016, "loss": "11.337", "nll_loss": "10.169", "ppl": "1151.1", "wps": "9533.2", "ups": "1.36", "wpb": "7015.8", "bsz": "249.6", "num_updates": "190", "lr": "2.375e-05", "gnorm": "0.438", "train_wall": "1", "gb_free": "31.4", "wall": "31"}
2022-06-21 14:13:36 | INFO | train_inner | {"epoch": 2, "update": 1.07, "loss": "11.265", "nll_loss": "10.035", "ppl": "1048.88", "wps": "92132.4", "ups": "11.09", "wpb": "8306.8", "bsz": "256", "num_updates": "200", "lr": "2.5e-05", "gnorm": "0.426", "train_wall": "1", "gb_free": "31.2", "wall": "32"}
2022-06-21 14:13:37 | INFO | train_inner | {"epoch": 2, "update": 1.123, "loss": "11.242", "nll_loss": "9.996", "ppl": "1020.92", "wps": "88286.2", "ups": "10.88", "wpb": "8113.7", "bsz": "256", "num_updates": "210", "lr": "2.625e-05", "gnorm": "0.383", "train_wall": "1", "gb_free": "31.3", "wall": "32"}
2022-06-21 14:13:38 | INFO | train_inner | {"epoch": 2, "update": 1.176, "loss": "11.225", "nll_loss": "9.976", "ppl": "1007.1", "wps": "80581.4", "ups": "11.05", "wpb": "7295.1", "bsz": "256", "num_updates": "220", "lr": "2.75e-05", "gnorm": "0.453", "train_wall": "1", "gb_free": "31.4", "wall": "33"}
2022-06-21 14:13:39 | INFO | train_inner | {"epoch": 2, "update": 1.23, "loss": "11.182", "nll_loss": "9.892", "ppl": "949.9", "wps": "75804.7", "ups": "11", "wpb": "6890.5", "bsz": "253.6", "num_updates": "230", "lr": "2.875e-05", "gnorm": "0.352", "train_wall": "1", "gb_free": "31.4", "wall": "34"}
2022-06-21 14:13:40 | INFO | train_inner | {"epoch": 2, "update": 1.283, "loss": "11.21", "nll_loss": "9.937", "ppl": "980.03", "wps": "81275.6", "ups": "11.45", "wpb": "7100.1", "bsz": "256", "num_updates": "240", "lr": "3e-05", "gnorm": "0.486", "train_wall": "1", "gb_free": "31.4", "wall": "35"}
2022-06-21 14:13:40 | INFO | train_inner | {"epoch": 2, "update": 1.337, "loss": "11.125", "nll_loss": "9.785", "ppl": "882.12", "wps": "79558.1", "ups": "10.73", "wpb": "7412.2", "bsz": "256", "num_updates": "250", "lr": "3.125e-05", "gnorm": "0.322", "train_wall": "1", "gb_free": "31.3", "wall": "36"}
2022-06-21 14:13:41 | INFO | train_inner | {"epoch": 2, "update": 1.39, "loss": "11.082", "nll_loss": "9.693", "ppl": "827.66", "wps": "89686.4", "ups": "10.86", "wpb": "8257.4", "bsz": "256", "num_updates": "260", "lr": "3.25e-05", "gnorm": "0.344", "train_wall": "1", "gb_free": "31.3", "wall": "37"}
2022-06-21 14:13:42 | INFO | train_inner | {"epoch": 2, "update": 1.444, "loss": "11.059", "nll_loss": "9.649", "ppl": "802.98", "wps": "79238.7", "ups": "10.63", "wpb": "7450.9", "bsz": "256", "num_updates": "270", "lr": "3.375e-05", "gnorm": "0.316", "train_wall": "1", "gb_free": "31.4", "wall": "38"}
2022-06-21 14:13:43 | INFO | train_inner | {"epoch": 2, "update": 1.497, "loss": "11.034", "nll_loss": "9.593", "ppl": "772.3", "wps": "77402.6", "ups": "10.75", "wpb": "7197.3", "bsz": "256", "num_updates": "280", "lr": "3.5e-05", "gnorm": "0.318", "train_wall": "1", "gb_free": "31.3", "wall": "39"}
2022-06-21 14:13:44 | INFO | train_inner | {"epoch": 2, "update": 1.551, "loss": "11.009", "nll_loss": "9.532", "ppl": "740.36", "wps": "81149.7", "ups": "9.85", "wpb": "8238.2", "bsz": "256", "num_updates": "290", "lr": "3.625e-05", "gnorm": "0.345", "train_wall": "1", "gb_free": "31.2", "wall": "40"}
2022-06-21 14:13:45 | INFO | train_inner | {"epoch": 2, "update": 1.604, "loss": "11.027", "nll_loss": "9.56", "ppl": "754.98", "wps": "90252.3", "ups": "11.51", "wpb": "7842.5", "bsz": "256", "num_updates": "300", "lr": "3.75e-05", "gnorm": "0.39", "train_wall": "1", "gb_free": "31.3", "wall": "41"}
2022-06-21 14:13:46 | INFO | train_inner | {"epoch": 2, "update": 1.658, "loss": "10.981", "nll_loss": "9.461", "ppl": "704.65", "wps": "84164.3", "ups": "11.13", "wpb": "7562.4", "bsz": "256", "num_updates": "310", "lr": "3.875e-05", "gnorm": "0.27", "train_wall": "1", "gb_free": "31.5", "wall": "42"}
2022-06-21 14:13:47 | INFO | train_inner | {"epoch": 2, "update": 1.711, "loss": "10.956", "nll_loss": "9.412", "ppl": "681.43", "wps": "84797.7", "ups": "10.86", "wpb": "7806.1", "bsz": "253.1", "num_updates": "320", "lr": "4e-05", "gnorm": "0.288", "train_wall": "1", "gb_free": "31.2", "wall": "43"}
2022-06-21 14:13:48 | INFO | train_inner | {"epoch": 2, "update": 1.765, "loss": "10.94", "nll_loss": "9.373", "ppl": "663.07", "wps": "83795", "ups": "10.89", "wpb": "7691.5", "bsz": "256", "num_updates": "330", "lr": "4.125e-05", "gnorm": "0.304", "train_wall": "1", "gb_free": "30.6", "wall": "43"}
2022-06-21 14:13:49 | INFO | train_inner | {"epoch": 2, "update": 1.818, "loss": "10.958", "nll_loss": "9.392", "ppl": "672.03", "wps": "80998.5", "ups": "11.18", "wpb": "7242.9", "bsz": "256", "num_updates": "340", "lr": "4.25e-05", "gnorm": "0.341", "train_wall": "1", "gb_free": "31.4", "wall": "44"}
2022-06-21 14:13:50 | INFO | train_inner | {"epoch": 2, "update": 1.872, "loss": "10.909", "nll_loss": "9.296", "ppl": "628.59", "wps": "87583.1", "ups": "10.5", "wpb": "8337.7", "bsz": "256", "num_updates": "350", "lr": "4.375e-05", "gnorm": "0.259", "train_wall": "1", "gb_free": "31.2", "wall": "45"}
2022-06-21 14:13:51 | INFO | train_inner | {"epoch": 2, "update": 1.925, "loss": "10.927", "nll_loss": "9.321", "ppl": "639.62", "wps": "83369.4", "ups": "11.16", "wpb": "7468.2", "bsz": "256", "num_updates": "360", "lr": "4.5e-05", "gnorm": "0.382", "train_wall": "1", "gb_free": "31.3", "wall": "46"}
2022-06-21 14:13:52 | INFO | train_inner | {"epoch": 2, "update": 1.979, "loss": "10.922", "nll_loss": "9.295", "ppl": "628.05", "wps": "79834.8", "ups": "10.65", "wpb": "7493.4", "bsz": "256", "num_updates": "370", "lr": "4.625e-05", "gnorm": "0.338", "train_wall": "1", "gb_free": "31.4", "wall": "47"}
2022-06-21 14:13:52 | INFO | fairseq_cli.train | begin validation on "valid" subset
2022-06-21 14:13:55 | INFO | valid | {"epoch": 2, "valid_loss": "10.802", "valid_nll_loss": "9.026", "valid_ppl": "521.3", "valid_wps": "219949", "valid_wpb": "7421.2", "valid_bsz": "244.4", "valid_num_updates": "374", "valid_best_loss": "10.802"}
2022-06-21 14:13:55 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 2 @ 374 updates
2022-06-21 14:13:55 | INFO | fairseq.trainer | Saving checkpoint to /home/VD/cychang/ironside_nmt/bpe_pcm_en_300_32_1024_ffnn_checkpoints/checkpoint_best.pt
2022-06-21 14:13:56 | INFO | fairseq.trainer | Finished saving checkpoint to /home/VD/cychang/ironside_nmt/bpe_pcm_en_300_32_1024_ffnn_checkpoints/checkpoint_best.pt
2022-06-21 14:13:56 | INFO | fairseq.checkpoint_utils | Saved checkpoint /home/VD/cychang/ironside_nmt/bpe_pcm_en_300_32_1024_ffnn_checkpoints/checkpoint_best.pt (epoch 2 @ 374 updates, score 10.802) (writing took 0.8906798241659999 seconds)
2022-06-21 14:13:56 | INFO | fairseq_cli.train | end of epoch 2 (average epoch stats below)
2022-06-21 14:13:56 | INFO | train | {"epoch": 2, "train_loss": "11.059", "train_nll_loss": "9.621", "train_ppl": "787.57", "train_wps": "59346.4", "train_ups": "7.8", "train_wpb": "7612.5", "train_bsz": "255.4", "train_num_updates": "374", "train_lr": "4.675e-05", "train_gnorm": "0.351", "train_train_wall": "17", "train_gb_free": "31.3", "train_wall": "52"}
2022-06-21 14:13:56 | INFO | fairseq.data.iterators | grouped total_num_itrs = 187
2022-06-21 14:13:56 | INFO | fairseq.trainer | begin training epoch 3
2022-06-21 14:13:56 | INFO | fairseq_cli.train | Start iterating over samples
2022-06-21 14:13:59 | INFO | train_inner | {"epoch": 3, "update": 2.032, "loss": "10.903", "nll_loss": "9.252", "ppl": "609.64", "wps": "10757.4", "ups": "1.32", "wpb": "8164.5", "bsz": "249.6", "num_updates": "380", "lr": "4.75e-05", "gnorm": "0.395", "train_wall": "1", "gb_free": "31.1", "wall": "55"}
2022-06-21 14:14:00 | INFO | train_inner | {"epoch": 3, "update": 2.086, "loss": "10.867", "nll_loss": "9.177", "ppl": "578.95", "wps": "85235.7", "ups": "10.85", "wpb": "7855.8", "bsz": "256", "num_updates": "390", "lr": "4.875e-05", "gnorm": "0.308", "train_wall": "1", "gb_free": "31", "wall": "56"}
2022-06-21 14:14:01 | INFO | train_inner | {"epoch": 3, "update": 2.139, "loss": "10.863", "nll_loss": "9.153", "ppl": "569.14", "wps": "82461.3", "ups": "10.98", "wpb": "7511", "bsz": "256", "num_updates": "400", "lr": "5e-05", "gnorm": "0.365", "train_wall": "1", "gb_free": "31.2", "wall": "57"}
2022-06-21 14:14:02 | INFO | train_inner | {"epoch": 3, "update": 2.193, "loss": "10.91", "nll_loss": "9.236", "ppl": "602.79", "wps": "81537.8", "ups": "10.89", "wpb": "7484.6", "bsz": "256", "num_updates": "410", "lr": "5.125e-05", "gnorm": "0.513", "train_wall": "1", "gb_free": "31.3", "wall": "58"}
2022-06-21 14:14:03 | INFO | train_inner | {"epoch": 3, "update": 2.246, "loss": "10.832", "nll_loss": "9.076", "ppl": "539.7", "wps": "84364.2", "ups": "11.41", "wpb": "7396.4", "bsz": "256", "num_updates": "420", "lr": "5.25e-05", "gnorm": "0.361", "train_wall": "1", "gb_free": "31.3", "wall": "58"}
